"use strict";(self.webpackChunkguide_pycord_dev=self.webpackChunkguide_pycord_dev||[]).push([[3303],{8624:function(e,n,o){o.d(n,{v:function(){return a}});var t=o(7294),i=o(7674),a=Object.assign({},i.TW,{profiles:{bob:{author:"BobDotCom",avatar:"/img/bob.png",roleColor:"#2cd6f7"},robocord:{author:"Robocord",avatar:"/img/robocord.png",roleColor:"#9b59b6",bot:!0},dorukyum:{author:"Dorukyum",avatar:"/img/dorukyum.png",roleColor:"#2cd6f7"}}});n.Z=function(e){var n=e.options,o=void 0===n?a:n,r=e.children;return t.createElement(i.qs.Provider,{value:o},t.createElement(i.dZ,null,r))}},4019:function(e,n,o){o.r(n),o.d(n,{assets:function(){return p},contentTitle:function(){return l},default:function(){return h},frontMatter:function(){return s},metadata:function(){return u},toc:function(){return m}});var t=o(7462),i=o(3366),a=(o(7294),o(3905)),r=o(7674),c=o(8624),d=["components"],s={title:"Receiving Voice Samples"},l="About",u={unversionedId:"voice/receiving",id:"voice/receiving",title:"Receiving Voice Samples",description:"Pycord tries to keep the recording of audio as simple and easy as possible, to keep making Discord",source:"@site/docs/voice/receiving.mdx",sourceDirName:"voice",slug:"/voice/receiving",permalink:"/voice/receiving",draft:!1,editUrl:"https://github.com/Pycord-Development/guide/tree/main/docs/voice/receiving.mdx",tags:[],version:"current",lastUpdatedBy:"Lala Sabathil",lastUpdatedAt:1713441056,formattedLastUpdatedAt:"Apr 18, 2024",frontMatter:{title:"Receiving Voice Samples"},sidebar:"defaultSidebar",previous:{title:"Wavelink Audio Player",permalink:"/voice/playing"},next:{title:"Popular Topics",permalink:"/category/popular-topics"}},p={},m=[{value:"Starting out",id:"starting-out",level:2},{value:"Making a Callback",id:"making-a-callback",level:3},{value:"Making a Stop Command",id:"making-a-stop-command",level:3}],k={toc:m},g="wrapper";function h(e){var n=e.components,o=(0,i.Z)(e,d);return(0,a.kt)(g,(0,t.Z)({},k,o,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"about"},"About"),(0,a.kt)("p",null,"Pycord tries to keep the recording of audio as simple and easy as possible, to keep making Discord\nbots of any kind easy for all audiences. This guide provides simple and easy examples of using the\naudio recording feature."),(0,a.kt)("p",null,"For users that want extra examples, you can find some in Pycord's\n",(0,a.kt)("a",{parentName:"p",href:"https://github.com/Pycord-Development/pycord/blob/master/examples/audio_recording.py"},"GitHub repository"),"."),(0,a.kt)("h2",{id:"starting-out"},"Starting out"),(0,a.kt)("p",null,"The first thing you want to do is make a cache of your voice connections. This is fairly easy; as\nit's just putting a variable with an empty dictionary in our code, such as ",(0,a.kt)("inlineCode",{parentName:"p"},"connections = {}"),"."),(0,a.kt)("p",null,"You will now want to create your command for recording."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-py",metastring:'title="Record Command Example"',title:'"Record',Command:!0,'Example"':!0},'import discord\n\nbot = discord.Bot()\nconnections = {}\n\n@bot.command()\nasync def record(ctx):  # If you\'re using commands.Bot, this will also work.\n    voice = ctx.author.voice\n\n    if not voice:\n        await ctx.respond("You aren\'t in a voice channel!")\n\n    vc = await voice.channel.connect()  # Connect to the voice channel the author is in.\n    connections.update({ctx.guild.id: vc})  # Updating the cache with the guild and channel.\n\n    vc.start_recording(\n        discord.sinks.WaveSink(),  # The sink type to use.\n        once_done,  # What to do once done.\n        ctx.channel  # The channel to disconnect from.\n    )\n    await ctx.respond("Started recording!")\n')),(0,a.kt)(c.Z,{mdxType:"DiscordComponent"},(0,a.kt)(r.kK,{profile:"robocord",mdxType:"DiscordMessage"},(0,a.kt)("div",{slot:"interactions"},(0,a.kt)(r.un,{profile:"bob",command:!0,mdxType:"DiscordInteraction"},"record")),"Started recording!")),(0,a.kt)("br",null),(0,a.kt)("p",null,"Now you are finished making your command for voice receiving! Next, you will want to:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Make your finished callback"),(0,a.kt)("li",{parentName:"ol"},"Make a stop command")),(0,a.kt)("h3",{id:"making-a-callback"},"Making a Callback"),(0,a.kt)("p",null,"To make a callback, you will want to define the currently undefined ",(0,a.kt)("inlineCode",{parentName:"p"},"once_done")," function inside\nour command, like so:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-py",metastring:'title="Recorder Callback"',title:'"Recorder','Callback"':!0},'async def once_done(sink: discord.sinks, channel: discord.TextChannel, *args):  # Our voice client already passes these in.\n    recorded_users = [  # A list of recorded users\n        f"<@{user_id}>"\n        for user_id, audio in sink.audio_data.items()\n    ]\n    await sink.vc.disconnect()  # Disconnect from the voice channel.\n    files = [discord.File(audio.file, f"{user_id}.{sink.encoding}") for user_id, audio in sink.audio_data.items()]  # List down the files.\n    await channel.send(f"finished recording audio for: {\', \'.join(recorded_users)}.", files=files)  # Send a message with the accumulated files.\n')),(0,a.kt)(c.Z,{mdxType:"DiscordComponent"},(0,a.kt)(r.kK,{profile:"robocord",mdxType:"DiscordMessage"},"finished recording audio for:"," ",(0,a.kt)(r.Hz,{highlight:!0,mdxType:"DiscordMention"},c.v.profiles.bob.author))),(0,a.kt)("br",null),(0,a.kt)("p",null,"Now that you've done this, the only thing left to do is make your stop command."),(0,a.kt)("h3",{id:"making-a-stop-command"},"Making a Stop Command"),(0,a.kt)("p",null,"The final step to this guide is stopping the audio recording. This is the easiest step by far."),(0,a.kt)("p",null,"To make it, you will want to do the following:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-py",metastring:'title="Stop Recording Command"',title:'"Stop',Recording:!0,'Command"':!0},'@bot.command()\nasync def stop_recording(ctx):\n    if ctx.guild.id in connections:  # Check if the guild is in the cache.\n        vc = connections[ctx.guild.id]\n        vc.stop_recording()  # Stop recording, and call the callback (once_done).\n        del connections[ctx.guild.id]  # Remove the guild from the cache.\n        await ctx.delete()  # And delete.\n    else:\n        await ctx.respond("I am currently not recording here.")  # Respond with this if we aren\'t recording.\n\nbot.run("token")\n')),(0,a.kt)("p",null,"Congratulations! You have now implemented voice recording into your bot! Most bots and Discord API\nwrappers don't have this as a feature, so this is quite an accomplishment. Thankfully, Pycord makes\nit easy to make complex bots so that you can get even the most advanced of ideas down."),(0,a.kt)("admonition",{title:"Related Topics",type:"info"},(0,a.kt)("ul",{parentName:"admonition"},(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"../getting-started/rules-and-common-practices"},"Rules and Common Practices")))))}h.isMDXComponent=!0}}]);